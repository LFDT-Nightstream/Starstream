# Starstream DSL - Consolidated Project

This folder contains the consolidated Starstream DSL project with all components merged from the split architecture.

## ðŸš€ Quick Start

### Run Tests

```bash
# Run all tests
cargo test
```

### Build for WASM

```bash
cargo build --target wasm32-unknown-unknown --release
```

## ðŸ§ª Insta Snapshot Testing

The project includes a comprehensive snapshot testing system using the [Insta](https://insta.rs/) framework that ensures the compiler and interpreter produce consistent output:

### Test Structure

```rust
#[test]
fn thing() {
    let src = indoc! {"
        fn myFunction() {

        }
    "}
}
```

- **Input Files**: `.imp` files in `tests/snapshots/inputs/`
- **Snapshot Files**: `.snap` files generated by Insta
  - AST snapshots: Parsed Abstract Syntax Trees
  - Opcodes snapshots: Compiled stack machine opcodes
  - Error snapshots: Expected error outputs

### Running Snapshot Tests

```bash
# Using cargo insta (recommended)
cargo insta test
cargo insta review
cargo insta accept
```

## ðŸ“¦ Components

### Core Types (`starstream-types/`)

- **AST**: Abstract Syntax Tree for IMP-like language
- **Errors**: Comprehensive error handling

### Compiler (`starstream-compiler/`)

- **Parser**: Simple but functional parser for basic expressions
  - Handles variable declarations, assignments, arithmetic
  - Parses binary expressions with proper precedence
- **Compiler**: Compiles AST to WASM
  - Handles variable declarations and assignments
  - Symbol table management

### Interpreter (`starstream-interpreter/`)

- Tree-walking interpreter for IMP-like language
- Execution context with stack and variables
- Step-by-step execution capability

## ðŸ”§ Architecture

The project follows a clean separation of concerns:

1. **Parser**: Source code â†’ AST
2. **Compiler**: AST â†’ WASM
3. **Interpreter**: AST â†’ Execution

## ðŸ“‹ Development Status

### âœ… Completed

- Basic parser for expressions and variable declarations
- Complete example demonstrating the pipeline
- Test suite with integration tests
- WASM support for browser deployment

### ðŸ“‹ Future Features

- Coroutine support (yield/resume)
- Algebraic effects system
- Linear type system
- Memory consistency checks
- Full Starstream language features

## ðŸ“š References

- [Design Document](docs/design.md) - Architecture and motivation
- [Language Spec](docs/language-spec.md) - Language Spec
- [Implementation Plan](impl-plan.md) - Development roadmap
